<!DOCTYPE html>
<html lang="en-gb"><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset="utf-8">
<meta http-equiv="content-type" content="text/html">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title itemprop="name">HOW DOES HALF PROXY WORK | Samir Deshar</title>
<meta property="og:title" content="HOW DOES HALF PROXY WORK | Samir Deshar" />
<meta name="twitter:title" content="HOW DOES HALF PROXY WORK | Samir Deshar" />
<meta itemprop="name" content="HOW DOES HALF PROXY WORK | Samir Deshar" />
<meta name="application-name" content="HOW DOES HALF PROXY WORK | Samir Deshar" />
<meta property="og:site_name" content="Samir Deshar" />

<meta name="description" content="Let&#39;s learn how the half proxy works.">
<meta itemprop="description" content="Let&#39;s learn how the half proxy works." />
<meta property="og:description" content="Let&#39;s learn how the half proxy works." />
<meta name="twitter:description" content="Let&#39;s learn how the half proxy works." />

<meta property="og:locale" content="en-gb" />
<meta name="language" content="en-gb" />

  <link rel="alternate" hreflang="en-gb" href="http://localhost:1313/posts/half-proxy/halfproxy/" title="English" />





    
    
    

    <meta property="og:type" content="article" />
    <meta property="og:article:published_time" content=2024-10-18T00:00:00Z />
    <meta property="article:published_time" content=2024-10-18T00:00:00Z />
    <meta property="og:url" content="http://localhost:1313/posts/half-proxy/halfproxy/" />

    
    <meta property="og:article:author" content="SAMIR DESHAR" />
    <meta property="article:author" content="SAMIR DESHAR" />
    <meta name="author" content="SAMIR DESHAR" />
    
    

    

    <script defer type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "Article",
        "headline": "HOW DOES HALF PROXY WORK",
        "author": {
        "@type": "Person",
        "name": ""
        },
        "datePublished": "2024-10-18",
        "description": "Let's learn how the half proxy works.",
        "wordCount":  512 ,
        "mainEntityOfPage": "True",
        "dateModified": "2024-10-18",
        "image": {
        "@type": "imageObject",
        "url": ""
        },
        "publisher": {
        "@type": "Organization",
        "name": "Samir Deshar"
        }
    }
    </script>


<meta name="generator" content="Hugo 0.135.0">

    
    <meta property="og:url" content="http://localhost:1313/posts/half-proxy/halfproxy/">
  <meta property="og:site_name" content="Samir Deshar">
  <meta property="og:title" content="HOW DOES HALF PROXY WORK">
  <meta property="og:description" content="Let&#39;s learn how the half proxy works.">
  <meta property="og:locale" content="en_gb">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-10-18T00:00:00+00:00">
    <meta property="article:modified_time" content="2024-10-18T00:00:00+00:00">


    
    
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="HOW DOES HALF PROXY WORK">
  <meta name="twitter:description" content="Let&#39;s learn how the half proxy works.">


    

    <link rel="canonical" href="http://localhost:1313/posts/half-proxy/halfproxy/">
    <link href="/style.min.a94d01c45d6488cf633cab302d6fbee459506be059c518b594c69097e4570aeb.css" rel="stylesheet">
    <link href="/code-highlight.min.706d31975fec544a864cb7f0d847a73ea55ca1df91bf495fd12a177138d807cf.css" rel="stylesheet">

    
    <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
    <link rel="mask-icon" href="/icons/safari-pinned-tab.svg">
    <link rel="shortcut icon" href="/favicon.ico">




<link rel="manifest" href="http://localhost:1313/site.webmanifest">

<meta name="msapplication-config" content="/browserconfig.xml">
<meta name="msapplication-TileColor" content="#2d89ef">
<meta name="theme-color" content="#434648">

    
    <link rel="icon" type="image/svg+xml" href="/icons/favicon.svg">

    <script src="../../assets/js/copyCode.js"></script>
</head>
<body data-theme = "dark" class="notransition">

<script src="/js/theme.js"></script>

<div class="navbar" role="navigation">
    <nav class="menu" aria-label="Main Navigation">
        <a href="http://localhost:1313/" class="logo">
            <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" 
viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" 
stroke-linejoin="round" class="feather feather-home">
<title>Home</title>
<path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
<polyline points="9 22 9 12 15 12 15 22"></polyline>
</svg>
        </a>
        <input type="checkbox" id="menu-trigger" class="menu-trigger" />
        <label for="menu-trigger">
            <span class="menu-icon">
                <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" stroke="currentColor" fill="none" viewBox="0 0 14 14"><title>Menu</title><path stroke-linecap="round" stroke-linejoin="round" d="M10.595 7L3.40726 7"></path><path stroke-linecap="round" stroke-linejoin="round" d="M10.5096 3.51488L3.49301 3.51488"></path><path stroke-linecap="round" stroke-linejoin="round" d="M10.5096 10.4851H3.49301"></path><path stroke-linecap="round" stroke-linejoin="round" d="M0.5 12.5V1.5C0.5 0.947715 0.947715 0.5 1.5 0.5H12.5C13.0523 0.5 13.5 0.947715 13.5 1.5V12.5C13.5 13.0523 13.0523 13.5 12.5 13.5H1.5C0.947715 13.5 0.5 13.0523 0.5 12.5Z"></path></svg>
            </span>
        </label>

        <div class="trigger">
            <ul class="trigger-container">
                
                
                <li>
                    <a class="menu-link " href="/">
                        /home
                    </a>
                    
                </li>
                
                <li>
                    <a class="menu-link active" href="/posts/">
                        /etc/posts
                    </a>
                    
                </li>
                
                <li>
                    <a class="menu-link " href="/pages/about/">
                        &gt; whoami
                    </a>
                    
                </li>
                
                <li class="menu-separator">
                    <span>|</span>
                </li>
                
                
            </ul>
            <a id="mode" href="#">
                <svg xmlns="http://www.w3.org/2000/svg" class="mode-sunny" width="21" height="21" viewBox="0 0 14 14" stroke-width="1">
<title>LIGHT</title><g><circle cx="7" cy="7" r="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></circle><line x1="7" y1="0.5" x2="7" y2="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="2.4" y1="2.4" x2="3.82" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="0.5" y1="7" x2="2.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="2.4" y1="11.6" x2="3.82" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="7" y1="13.5" x2="7" y2="11.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="11.6" y1="11.6" x2="10.18" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="13.5" y1="7" x2="11.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="11.6" y1="2.4" x2="10.18" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"></line></g></svg>
                <svg xmlns="http://www.w3.org/2000/svg" class="mode-moon" width="21" height="21" viewBox="0 0 14 14" stroke-width="1">
<title>DARK</title><g><circle cx="7" cy="7" r="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></circle><line x1="7" y1="0.5" x2="7" y2="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="2.4" y1="2.4" x2="3.82" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="0.5" y1="7" x2="2.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="2.4" y1="11.6" x2="3.82" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="7" y1="13.5" x2="7" y2="11.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="11.6" y1="11.6" x2="10.18" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="13.5" y1="7" x2="11.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="11.6" y1="2.4" x2="10.18" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"></line></g></svg>
            </a>
        </div>
    </nav>
</div>

<div class="wrapper post">
    <main class="page-content" aria-label="Content">
        <article>
            <header class="header">
                <h1 class="header-title">HOW DOES HALF PROXY WORK</h1>
                
                
                
                <div class="post-meta">
                    <time datetime="2024-10-18T00:00:00&#43;00:00" itemprop="datePublished"> 18 Oct 2024 </time>
                </div>
                
            </header>
            
    
    <details class="toc" ZgotmplZ>
        <summary><b>Table of Contents</b></summary>
        <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#step-on-how-this-works-and-why-would-client-accept-the-response-from-a-completely-new-ip-than-the-proxy-vs-which-we-had-requested-for">Step on how this works and why would client accept the response from a completely new ip than the proxy VS which we had requested for?</a></li>
        <li><a href="#why-does-the-client-accept-the-response-from-a-different-ip">Why Does the Client Accept the Response from a Different IP?</a></li>
      </ul>
    </li>
    <li><a href="#important-points-in-dsrhalf-proxy">Important Points in DSR/Half Proxy:</a></li>
  </ul>
</nav>
    </details>
            <div class="page-content">
                <p>So basically the half proxies are those that initiate connection to the proxy and forward the connection to the server. While the server repose directly back to the client.
This is also known as DSR(Direct Server Response).</p>
<h3 id="step-on-how-this-works-and-why-would-client-accept-the-response-from-a-completely-new-ip-than-the-proxy-vs-which-we-had-requested-for">Step on how this works and why would client accept the response from a completely new ip than the proxy VS which we had requested for?</h3>
<p>Let&rsquo;s assume following.
<strong>CLIENT</strong> -&gt; 192.168.1.1
<strong>VS</strong>/<strong>PROXY</strong> -&gt; 10.2.0.1
<strong>SERVER</strong> -&gt; 10.3.0.1</p>
<p>STEPS:</p>
<ol>
<li>
<p><strong>Client Initiates a Request:</strong></p>
<ul>
<li><strong>Client IP:</strong> <code>192.168.1.1</code></li>
<li><strong>Virtual Server (VS)/Proxy IP:</strong> <code>10.2.0.1</code></li>
<li><strong>Server IP:</strong> <code>10.3.0.1</code></li>
</ul>
<p>The client sends a request to the Virtual Server (VS) or proxy IP (<code>10.2.0.1</code>). This VS IP is usually configured on the proxy or load balancer.</p>
<pre><code> Source IP: 192.168.1.1
 Destination IP: 10.2.0.1 (VS/Proxy)
</code></pre>
</li>
<li>
<p><strong>Proxy Receives and Forwards the Request:</strong></p>
<ul>
<li>The request reaches the VS (<code>10.2.0.1</code>). In a half proxy/DSR setup, the proxy does not modify the source or destination IP addresses when forwarding the request to the backend server (<code>10.3.0.1</code>).</li>
</ul>
<p>The proxy simply forwards the packet to the backend server with the following headers:
Source IP: 192.168.1.1
Destination IP: 10.2.0.1 (VS/Proxy IP)</p>
</li>
<li>
<p><strong>Server Accepts the Packet with VS IP:</strong></p>
<ul>
<li>Here’s where DSR comes into play. The backend server (<code>10.3.0.1</code>) is configured with a <strong>secondary IP address</strong> (also known as a loopback or alias IP) that matches the VS IP (<code>10.2.0.1</code>).</li>
<li>Because the server sees the destination IP as <code>10.2.0.1</code>, and it has this IP configured as a secondary IP, it accepts the packet as if it was meant for itself.</li>
</ul>
</li>
<li>
<p><strong>Server Sends the Response:</strong></p>
<ul>
<li>
<p>When the server responds, the <strong>source IP of the response</strong> is set to the destination IP of the incoming packet, which is the VS IP (<code>10.2.0.1</code>).</p>
</li>
<li>
<p>The response packet has the following headers</p>
<pre><code>  Source IP: 10.2.0.1 (VS IP, configured as server loopback)
  Destination IP: 192.168.1.1 (Client IP)
</code></pre>
</li>
</ul>
</li>
<li>
<p><strong>Response Goes Directly to the Client:</strong></p>
<ul>
<li>The server sends the response <strong>directly to the client</strong> (<code>192.168.1.1</code>), bypassing the proxy or VS. This is why it’s called <strong>Direct Server Return (DSR)</strong>.</li>
<li>The client receives the response directly from the server (<code>10.3.0.1</code>), but it appears to be from the VS IP (<code>10.2.0.1</code>), which the client originally requested.</li>
</ul>
</li>
</ol>
<h3 id="why-does-the-client-accept-the-response-from-a-different-ip">Why Does the Client Accept the Response from a Different IP?</h3>
<ul>
<li>The key is that <strong>the client sees the same IP address</strong> it initially requested (i.e., <code>10.2.0.1</code>).</li>
<li>Even though the response is coming <strong>directly from the backend server</strong>, the <strong>source IP in the response</strong> is still set to the VS IP (<code>10.2.0.1</code>), making it look like it’s coming from the proxy or load balancer that the client originally contacted.</li>
</ul>
<h2 id="important-points-in-dsrhalf-proxy">Important Points in DSR/Half Proxy:</h2>
<ol>
<li><strong>Server Configuration:</strong>
<ul>
<li>The backend server must have the VS IP configured as a loopback or secondary IP to accept traffic destined for it.</li>
</ul>
</li>
<li><strong>IP Address Handling:</strong>
<ul>
<li>The VS IP is used for both forwarding the request and as the source of the server’s response, even though the response is sent directly from the server to the client.</li>
</ul>
</li>
<li><strong>Direct Server Response:</strong>
<ul>
<li>The server bypasses the proxy for responses, reducing the proxy’s load and improving response times.</li>
</ul>
</li>
</ol>
<footer class="footer">
    <span class="footer_item"> </span>
    &nbsp;

    <div class="footer_social-icons">
<a href="https://github.com/hugo-sid" target="_blank" rel="noopener noreferrer me"
    title="Github">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
    stroke-linecap="round" stroke-linejoin="round">
    <path
        d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22">
    </path>
</svg>
</a>
<a href="https://twitter.com" target="_blank" rel="noopener noreferrer me"
    title="Twitter">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
    stroke-linecap="round" stroke-linejoin="round">
    <path
        d="M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66 10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z">
    </path>
</svg>
</a>
<a href="/index.xml" target="_blank" rel="noopener noreferrer me"
    title="Rss">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
    stroke-linecap="round" stroke-linejoin="round">
    <path d="M4 11a9 9 0 0 1 9 9" />
    <path d="M4 4a16 16 0 0 1 16 16" />
    <circle cx="5" cy="19" r="1" />
</svg>
</a>
</div>
    <small class="footer_copyright">
        © 2024 SAMIR DESHAR.
        Powered by <a href="https://github.com/hugo-sid/hugo-blog-awesome" target="_blank" rel="noopener">Hugo blog awesome</a>.
    </small>
</footer><a href="#" title="Go to top" id="totop">
    <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" fill="currentColor" stroke="currentColor" viewBox="0 96 960 960">
    <path d="M283 704.739 234.261 656 480 410.261 725.739 656 677 704.739l-197-197-197 197Z"/>
</svg>

</a>


    




    
    
        
    

    
    
        
    



    
    <script async src="http://localhost:1313/js/main.js" ></script>

    

</body>
</html>
